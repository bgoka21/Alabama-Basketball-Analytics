{# templates/public/home.html #}
{% extends 'admin/base.html' %}
{% from 'macros/table.html' import render_table %}
{% block content %}
<a href="{{ url_for('pdf_home') }}" class="btn no-print">Download PDF</a>

<section class="bg-white py-12">
  <div class="max-w-7xl mx-auto px-4 text-center">
    <!-- Title + Subâ€title with accent underline -->
    <h1 class="text-2xl sm:text-5xl font-extrabold text-gray-900">Alabama Basketball</h1>
    <div class="w-24 h-1 bg-[#9E1B32] mx-auto mt-4"></div>
    <p class="mt-4 text-lg text-gray-600">Season Stats & Leaderboards</p>
  </div>

  <!-- Inline Summary Cards -->
  <div class="mt-8 max-w-7xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 px-4">
    {% for label, value in [
      ('Season Record',   summary.record),
      ('Avg. BCP/Game',   summary.avg_bcp),
      ('Avg. 3FG%',       summary.avg_fg3),
      ('Avg. Team PPG',   summary.avg_ppg)
    ] %}
    <div class="bg-[#9E1B32] text-white p-6 rounded-lg shadow-lg">
      <div class="text-sm font-semibold uppercase opacity-90">{{ label }}</div>
      <div class="mt-2 text-3xl font-bold">{{ value }}</div>
    </div>
    {% endfor %}
  </div>
</section>


  <!-- Filters (no change) -->
  <section class="px-4 mb-6">
    <!-- your existing Season / Last 5 / True Data buttons -->
  </section>

  <!-- Leaderboards (no change) -->
  <section class="px-4 grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- your existing cards for BCP, Hard Hats, 3FG%, ATR% -->
  </section>


<!-- Filter Row -->
  <div class="flex flex-wrap gap-4 mb-6 items-start justify-between">
    <div class="flex flex-wrap gap-4">
      <a href="{{ url_for('public.game_homepage', filter='season',  view=view_opt, sort=sort_by, game_type=selected_game_types, season_id=selected_season_id) }}"
         class="px-4 py-2 rounded {{ 'bg-[#9E1B32] text-white' if filter_opt=='season'  else 'bg-gray-200 text-black' }}">
        Season
      </a>
      <a href="{{ url_for('public.game_homepage', filter='last5',  view=view_opt, sort=sort_by, game_type=selected_game_types, season_id=selected_season_id) }}"
         class="px-4 py-2 rounded {{ 'bg-[#9E1B32] text-white' if filter_opt=='last5'  else 'bg-gray-200 text-black' }}">
        Last 5 Games
      </a>
      <a href="{{ url_for('public.game_homepage', filter='true_data', view=view_opt, sort=sort_by, game_type=selected_game_types, season_id=selected_season_id) }}"
         class="px-4 py-2 rounded {{ 'bg-[#9E1B32] text-white' if filter_opt=='true_data' else 'bg-gray-200 text-black' }}">
        True Data
      </a>
    </div>
    {% if seasons %}
    <form method="get" class="flex flex-wrap gap-3 items-center">
      <input type="hidden" name="filter" value="{{ filter_opt }}">
      <input type="hidden" name="view" value="{{ view_opt }}">
      <input type="hidden" name="sort" value="{{ sort_by }}">
      {% for gt in selected_game_types %}
        <input type="hidden" name="game_type" value="{{ gt }}">
      {% endfor %}
      <label for="season-select" class="text-sm font-semibold">Season:</label>
      <select id="season-select" name="season_id" class="rounded border-gray-300 text-sm px-3 py-2" onchange="this.form.submit()">
        {% for season in seasons %}
          <option value="{{ season.id }}" {% if season.id == selected_season_id %}selected{% endif %}>
            {{ season.season_name }}{% if season.id == current_season_id %} (Current){% endif %}
          </option>
        {% endfor %}
      </select>
    </form>
    {% endif %}
    <form method="get" class="flex flex-wrap gap-3 items-center">
      <input type="hidden" name="filter" value="{{ filter_opt }}">
      <input type="hidden" name="view" value="{{ view_opt }}">
      <input type="hidden" name="sort" value="{{ sort_by }}">
      <input type="hidden" name="season_id" value="{{ selected_season_id }}">
      <span class="text-sm font-semibold">Game Types:</span>
      <div class="flex flex-wrap gap-2">
        {% for option in game_type_options %}
          <label class="inline-flex items-center gap-2 text-sm bg-gray-100 px-3 py-1 rounded">
            <input
              type="checkbox"
              name="game_type"
              value="{{ option }}"
              class="rounded border-gray-300 text-blue-600 focus:ring-blue-500"
              {% if option in selected_game_types %}checked{% endif %}
              onchange="this.form.submit()"
            >
            <span>{{ option }}</span>
          </label>
        {% endfor %}
      </div>
    </form>
  </div>

<!-- 2x2 Grid Layout: 4 Equal Leaderboard Boxes -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

{% set bcp_cols = [
  {'key': 'player', 'label': 'Player', 'sortable': True, 'align': 'left', 'value_key': 'player_sort'},
  {'key': 'total_bcp', 'label': 'Total BCP', 'sortable': True, 'align': 'right'},
  {'key': 'possessions', 'label': 'Possessions', 'sortable': True, 'align': 'right'},
  {'key': 'poss_per_bcp', 'label': 'Poss / BCP', 'sortable': True, 'align': 'right'},
] %}
<div class="space-y-4">
  <h2 class="text-xl font-semibold">Blue Collar Points Leaders</h2>
  {{ render_table(
      id='home-bcp',
      columns=bcp_cols,
      rows=bcp_rows,
      totals=None,
      dense=True,
      sticky_header=True,
      caption='Blue Collar Points Leaders'
  ) }}
</div>

{% set hard_hat_cols = [
  {'key': 'player', 'label': 'Player', 'sortable': True, 'align': 'left', 'value_key': 'player_sort'},
  {'key': 'hard_hats', 'label': 'Hard Hats Won', 'sortable': True, 'align': 'right'},
] %}
<div class="space-y-4">
  <h2 class="text-xl font-semibold">Hard Hats</h2>
  {{ render_table(
      id='home-hard-hats',
      columns=hard_hat_cols,
      rows=hard_hat_rows,
      totals=None,
      dense=True,
      sticky_header=True,
      caption='Hard Hat Winners'
  ) }}
</div>

{% set fg3_cols = [
  {'key': 'player', 'label': 'Player', 'sortable': True, 'align': 'left', 'value_key': 'player_sort'},
  {'key': 'fg', 'label': 'FG', 'sortable': True, 'align': 'right'},
  {'key': 'fg_pct', 'label': 'FG%', 'sortable': True, 'align': 'right'},
] %}
<div class="space-y-4">
  <h2 class="text-xl font-semibold">3FG% Leaders</h2>
  {{ render_table(
      id='home-fg3',
      columns=fg3_cols,
      rows=fg3_rows,
      totals=fg3_totals,
      dense=True,
      sticky_header=True,
      caption='3FG% Leaders'
  ) }}
</div>

{% set atr_cols = [
  {'key': 'player', 'label': 'Player', 'sortable': True, 'align': 'left', 'value_key': 'player_sort'},
  {'key': 'fg', 'label': 'FG', 'sortable': True, 'align': 'right'},
  {'key': 'fg_pct', 'label': 'ATR%', 'sortable': True, 'align': 'right'},
] %}
<div class="space-y-4">
  <h2 class="text-xl font-semibold">ATR% Leaders</h2>
  {{ render_table(
      id='home-atr',
      columns=atr_cols,
      rows=atr_rows,
      totals=None,
      dense=True,
      sticky_header=True,
      caption='ATR% Leaders'
  ) }}
</div>

</div>


{% endblock %}
