{% from 'macros/table.html' import render_table %}

{% set source_value = (source or 'practice') %}
{% set source_title = 'Game' if source_value == 'game' else 'Practice' %}

<div class="custom-stats-table space-y-3">
  {{ render_table(
    id='custom-stats-table',
    columns=columns,
    rows=rows,
    totals=None,
    dense=True,
    sticky_header=True,
    caption='Custom ' ~ source_title|lower ~ ' stats',
    default_sort='player:asc',
    draggable_headers=True
  ) }}

  {% if rows | length == 0 %}
    <div class="table-empty">No {{ source_title|lower }} data found for the selected filters.</div>
  {% endif %}
</div>

<style>
  .custom-stats-table th.sticky-player-header {
    position: sticky;
    left: 0;
    z-index: 30;
    background: var(--tbl-header-bg, #F9FAFB);
    box-shadow: 2px 0 0 rgba(0, 0, 0, 0.05);
  }

  .custom-stats-table td.sticky-player-cell {
    position: sticky;
    left: 0;
    z-index: 20;
    background-color: var(--sticky-player-bg, transparent);
    box-shadow: 2px 0 0 rgba(0, 0, 0, 0.05);
  }

  .custom-stats-table tbody tr:nth-child(even) td.sticky-player-cell {
    background-color: var(--sticky-player-bg-even, #F9FAFB);
  }

  .dark .custom-stats-table td.sticky-player-cell {
    background-color: transparent;
    box-shadow: 2px 0 0 rgba(17, 24, 39, 0.6);
  }

  .dark .custom-stats-table tbody tr:nth-child(even) td.sticky-player-cell {
    background-color: var(--sticky-player-bg-even-dark, #1F2937);
  }

  .custom-stats-table [data-draggable-headers] .col-drag-handle {
    cursor: grab;
    font-size: 0.75rem;
    color: #9ca3af;
    line-height: 1;
    user-select: none;
    display: inline-flex;
    align-items: center;
  }

  .custom-stats-table [data-draggable-headers] th.drag-target {
    outline: 2px dashed #9E1B32;
    outline-offset: 2px;
  }
</style>
