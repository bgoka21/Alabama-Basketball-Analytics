{% extends 'admin/base.html' %}
{% from 'macros/dual_tables.html' import render_dual_section %}
{% from '_macros/percent_box.html' import apply_percent_wrappers %}
{% from '_macros/grade_scale.html' import render_grade_scales_for_specs %}

{% block page_controls %}
<form
  method="get"
  id="game-leaderboard-form"
  class="mb-4 flex flex-wrap items-end gap-4"
>
  <div>
    <label class="font-semibold mr-2">Season:</label>
    <select
      name="season"
      class="border p-2 rounded"
      hx-get="{{ url_for('admin.leaderboard_game') }}"
      hx-trigger="change delay:250ms"
      hx-target="#game-leaderboard-results"
      hx-include="#game-leaderboard-form"
      hx-select="#game-leaderboard-results"
      hx-swap="outerHTML"
      hx-push-url="true"
    >
      {% for s in all_seasons %}
        <option value="{{ s.id }}" {% if s.id == selected_season %}selected{% endif %}>
          {{ s.season_name }}
        </option>
      {% endfor %}
    </select>
  </div>
  {% for key, values in request.args.lists() %}
    {% if key not in ['season', 'start_date', 'end_date'] %}
      {% for v in values %}
        <input type="hidden" name="{{ key }}" value="{{ v }}">
      {% endfor %}
    {% endif %}
  {% endfor %}
  <div class="flex items-center gap-2">
    <label class="text-sm font-medium">Date:</label>
    <input
      type="date"
      name="start_date"
      value="{{ start_date or '' }}"
      class="border px-2 py-1 text-sm"
      hx-get="{{ url_for('admin.leaderboard_game') }}"
      hx-trigger="change delay:250ms"
      hx-target="#game-leaderboard-results"
      hx-include="#game-leaderboard-form"
      hx-select="#game-leaderboard-results"
      hx-swap="outerHTML"
      hx-push-url="true"
    >
    <span class="text-sm">â€“</span>
    <input
      type="date"
      name="end_date"
      value="{{ end_date or '' }}"
      class="border px-2 py-1 text-sm"
      hx-get="{{ url_for('admin.leaderboard_game') }}"
      hx-trigger="change delay:250ms"
      hx-target="#game-leaderboard-results"
      hx-include="#game-leaderboard-form"
      hx-select="#game-leaderboard-results"
      hx-swap="outerHTML"
      hx-push-url="true"
    >
  </div>
  <div>
    <button type="submit" class="bg-[#9E1B32] hover:bg-[#7f1524] text-white px-5 py-2 rounded">Apply</button>
  </div>
  <div>
    <a href="{{ url_for('admin.leaderboard_game') }}" class="text-gray-600 hover:underline text-sm">Clear</a>
  </div>
</form>
{% endblock %}

{% block content %}
  {% include 'admin/_game_leaderboard_results.html' %}
{% endblock %}
