{% extends 'admin/base.html' %}

{% block page_controls %}
<form method="get" class="mb-4 flex flex-wrap items-end gap-4">
  <div>
    <label class="block text-sm font-medium mb-1">Date</label>
    <input type="date" name="date" value="{{ selected_date.isoformat() }}" class="border p-2 rounded" />
  </div>
  <div class="flex items-center">
    <input type="checkbox" name="include_total" value="1" {% if include_total %}checked{% endif %} class="mr-2" />
    <label class="text-sm">Include Total Shots</label>
  </div>
  <div class="flex items-center">
    <input type="checkbox" name="hide_zeros" value="1" {% if hide_zeros %}checked{% endif %} class="mr-2" />
    <label class="text-sm">Hide Zeros</label>
  </div>
  <div>
    <label class="block text-sm font-medium mb-1">Sort</label>
    <select name="sort" class="border p-2 rounded">
      <option value="attempts" {% if sort == 'attempts' %}selected{% endif %}>Attempts</option>
      <option value="makes" {% if sort == 'makes' %}selected{% endif %}>Makes</option>
      <option value="pct" {% if sort == 'pct' %}selected{% endif %}>FT %</option>
      {% if include_total %}<option value="total" {% if sort == 'total' %}selected{% endif %}>Total Shots</option>{% endif %}
      <option value="name" {% if sort == 'name' %}selected{% endif %}>Name</option>
    </select>
  </div>
  <div>
    <label class="block text-sm font-medium mb-1">Dir</label>
    <select name="dir" class="border p-2 rounded">
      <option value="desc" {% if dir == 'desc' %}selected{% endif %}>Desc</option>
      <option value="asc" {% if dir == 'asc' %}selected{% endif %}>Asc</option>
    </select>
  </div>
  <div>
    <button type="submit" class="bg-[#9E1B32] hover:bg-[#7f1524] text-white px-5 py-2 rounded">Apply</button>
  </div>
  <div>
    <a href="{{ url_for('admin.ft_daily') }}" class="text-gray-600 hover:underline text-sm">Today</a>
  </div>
</form>
{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-4">Free Throws - {{ selected_date }}</h1>
<div class="overflow-x-auto">
  <table class="w-full table-auto border border-gray-200 rounded-md">
    <thead>
      <tr class="bg-gray-200">
        <th class="px-4 py-2 text-left text-sm font-medium">Player</th>
        <th class="px-4 py-2 text-center text-sm font-medium">FT Makes</th>
        <th class="px-4 py-2 text-center text-sm font-medium">FT Attempts</th>
        <th class="px-4 py-2 text-center text-sm font-medium">FT %</th>
        {% if include_total %}<th class="px-4 py-2 text-center text-sm font-medium">Total Shots</th>{% endif %}
      </tr>
    </thead>
    <tbody>
    {% for row in rows %}
      <tr class="{{ loop.cycle('bg-white','bg-gray-50') }}">
        <td class="px-4 py-2 text-sm">{{ row.player_name }}</td>
        <td class="px-4 py-2 text-center text-sm">{{ row.ft_makes }}</td>
        <td class="px-4 py-2 text-center text-sm">{{ row.ft_attempts }}</td>
        <td class="px-4 py-2 text-center text-sm">{{ '%.1f'|format(row.ft_pct) }}</td>
        {% if include_total %}<td class="px-4 py-2 text-center text-sm">{{ row.total_shots }}</td>{% endif %}
      </tr>
    {% else %}
      <tr>
        <td colspan="{{ 4 + (1 if include_total else 0) }}" class="px-4 py-2 text-center text-sm text-gray-500">No data</td>
      </tr>
    {% endfor %}
    </tbody>
    <tfoot>
      <tr class="bg-gray-200 font-semibold">
        <td class="px-4 py-2 text-sm">Totals</td>
        <td class="px-4 py-2 text-center text-sm">{{ totals.ft_makes }}</td>
        <td class="px-4 py-2 text-center text-sm">{{ totals.ft_attempts }}</td>
        <td class="px-4 py-2 text-center text-sm">{{ '%.1f'|format(totals.ft_pct) }}</td>
        {% if include_total %}<td class="px-4 py-2 text-center text-sm">{{ totals.total_shots }}</td>{% endif %}
      </tr>
    </tfoot>
  </table>
</div>
{% endblock %}
