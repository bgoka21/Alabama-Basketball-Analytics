{% extends 'admin/base.html' %}

{% block page_controls %}
<form method="get" class="mb-4 flex items-center gap-2">
  <label class="font-semibold">Start:</label>
  <input type="date" name="start_date" value="{{ start }}" class="border p-1 rounded" />
  <label class="font-semibold">End:</label>
  <input type="date" name="end_date" value="{{ end }}" class="border p-1 rounded" />
  <button type="submit" class="px-3 py-1 bg-[#9E1B32] text-white rounded">Filter</button>
</form>
{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold mb-4">Usage Report</h1>

<h2 class="text-xl font-semibold mt-4 mb-2">Views by User</h2>
<div class="overflow-x-auto mb-6">
  <table class="min-w-full divide-y divide-gray-200 shadow rounded-lg bg-white">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-4 py-2 text-left">Username</th>
        <th class="px-4 py-2">Views</th>
      </tr>
    </thead>
    <tbody>
      {% for username, count in user_stats %}
      <tr>
        <td class="px-4 py-2">{{ username or 'Anonymous' }}</td>
        <td class="px-4 py-2 text-center">{{ count }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<h2 class="text-xl font-semibold mt-4 mb-2">Views by Page</h2>
<div class="overflow-x-auto">
  <table class="min-w-full divide-y divide-gray-200 shadow rounded-lg bg-white">
    <thead class="bg-gray-100">
      <tr>
        <th class="px-4 py-2 text-left">Endpoint</th>
        <th class="px-4 py-2">Views</th>
      </tr>
    </thead>
    <tbody>
      {% for ep, count in page_stats %}
      <tr>
        <td class="px-4 py-2">{{ ep }}</td>
        <td class="px-4 py-2 text-center">{{ count }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
