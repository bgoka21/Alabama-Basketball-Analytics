{% extends "base.html" %}
{% block content %}
{# HERO HEADER #}
<div class="w-full rounded-xl mb-6 overflow-hidden">
  <div class="bg-[#9E1B32] text-white">
    <div class="max-w-7xl mx-auto px-4 py-6 flex flex-col sm:flex-row items-center gap-4">
      {% if recruit.profile_image_url %}
        <img src="{{ recruit.profile_image_url }}" alt="{{ recruit.name }} headshot"
             class="w-28 h-28 rounded-full ring-4 ring-white/20 object-cover"
             onerror="this.onerror=null;this.src='{{ url_for('static', filename='img/recruits/placeholder_headshot.png') }}';">
      {% else %}
        <img src="{{ url_for('static', filename='img/recruits/placeholder_headshot.png') }}" alt="Headshot"
             class="w-28 h-28 rounded-full ring-4 ring-white/20 object-cover">
      {% endif %}
      <div class="text-center sm:text-left">
        <h1 class="text-3xl sm:text-4xl font-extrabold leading-tight">{{ recruit.name }}</h1>
        <div class="mt-1 text-white/90 text-sm sm:text-base">
          {% if recruit.graduation_year %}Class of {{ recruit.graduation_year }} • {% endif %}
          {% if recruit.position %}{{ recruit.position }}{% endif %}
          {% if recruit.height %} • {{ recruit.height }}{% endif %}
          {% if recruit.weight %} • {{ recruit.weight }}{% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

{# INFO CARDS #}
<div class="max-w-7xl mx-auto px-4">
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
    {% if recruit.high_school %}
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-4">
        <div class="text-[11px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-semibold">High School</div>
        <div class="text-lg font-bold mt-1">{{ recruit.high_school }}</div>
      </div>
    {% endif %}
    {% if recruit.hometown %}
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-4">
        <div class="text-[11px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-semibold">Hometown</div>
        <div class="text-lg font-bold mt-1">{{ recruit.hometown }}</div>
      </div>
    {% endif %}
    {% if recruit.rating %}
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-4">
        <div class="text-[11px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-semibold">Rating</div>
        <div class="text-lg font-bold mt-1">{{ recruit.rating }}</div>
      </div>
    {% endif %}
    {% if recruit.ranking %}
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-4">
        <div class="text-[11px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-semibold">Ranking</div>
        <div class="text-lg font-bold mt-1">{{ recruit.ranking }}</div>
      </div>
    {% endif %}
    {% if recruit.aau_team is defined and recruit.aau_team %}
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-4">
        <div class="text-[11px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-semibold">AAU Team</div>
        <div class="text-lg font-bold mt-1">{{ recruit.aau_team }}</div>
      </div>
    {% endif %}
    {% if recruit.ppg is defined and recruit.ppg is not none %}
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-4">
        <div class="text-[11px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-semibold">PPG</div>
        <div class="text-lg font-bold mt-1">{{ '{:.1f}'.format(recruit.ppg) }}</div>
      </div>
    {% endif %}
    {% if overall_pps is defined %}
      <div class="bg-white dark:bg-gray-800 rounded-xl shadow p-4">
        <div class="text-[11px] uppercase tracking-wide text-gray-500 dark:text-gray-400 font-semibold">Points per Shot<span class="sr-only">Overall PPS</span></div>
        <div class="text-lg font-bold mt-1">{{ '{:.2f}'.format(overall_pps) }}</div>
      </div>
    {% endif %}
  </div>
</div>

  {# Use the shot type tables partial which already contains the
     overview cards acting as tabs. #}
  {% include "partials/shot_type_tables.html" with context %}


  <h3 class="text-xl font-semibold mb-2">Top Schools</h3>
  <ul class="mb-4 space-y-1">
    {% for s in recruit.top_schools %}
      <li>
        {{ s.rank }}. {{ s.school_name }}
      </li>
    {% endfor %}
  </ul>

  <script>
  function showTab(tabName) {
    ['seasonTotals','gameStats','shotType','skillDevelopment'].forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      el.classList.toggle('hidden', id !== tabName);
      el.classList.toggle('block',  id === tabName);
    });
    ['btnSeasonTotals','btnGameStats','btnShotType','btnSkillDevelopment'].forEach(btnId => {
      const b = document.getElementById(btnId);
      if (!b) return;
      if (btnId.toLowerCase().endsWith(tabName.toLowerCase())) {
        b.classList.add('bg-[#9E1B32]', 'text-white');
        b.classList.remove('border-gray-300','bg-white','text-gray-700');
      } else {
        b.classList.remove('bg-[#9E1B32]', 'text-white');
        b.classList.add('border-gray-300','bg-white','text-gray-700');
      }
    });
    window.location.hash = tabName;

    if (tabName === 'shotType') {
      showShotTypeDetail('atr');  // default into ATR whenever you open ShotType
    }
  }

  function showShotTypeDetail(detail) {
    ['atr','fg2','fg3'].forEach(id => {
      const el = document.getElementById(id);
      el.classList.toggle('hidden', id !== detail);
      el.classList.toggle('block',  id === detail);
    });
    const map = { atr:'ATR', fg2:'FG2', fg3:'FG3' };
    Object.entries(map).forEach(([type,suf]) => {
      const card = document.getElementById('card' + suf);
      if (type === detail) {
        card.classList.replace('bg-white','bg-gray-100');
        card.classList.replace('dark:bg-gray-800','dark:bg-gray-700');
        card.classList.replace('shadow-md','shadow-inner');
      } else {
        card.classList.replace('bg-gray-100','bg-white');
        card.classList.replace('dark:bg-gray-700','dark:bg-gray-800');
        card.classList.replace('shadow-inner','shadow-md');
      }
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    // Display the shot type section by default so clicking the
    // overview cards reveals their respective detail tables just
    // like on the player detail page.
    showTab('shotType');
  });
  </script>

{% endblock %}
